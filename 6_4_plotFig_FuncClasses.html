

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6_4_plotFig_FuncClasses module &mdash; pcsindels 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="6_3_plotFig_MutRatesComp module" href="6_3_plotFig_MutRatesComp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pcsindels
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_extractPCS.html">1_extractPCS module</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_computeWindows.html">2_computeWindows module</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_setupEvolTimes.html">3_setupEvolTimes module</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_estimateEvolTimes.html">4_estimateEvolTimes module</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_sampleEvolTimes.html">5_sampleEvolTimes module</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_1_plotFig_PcsDistribComp.html">6_1_plotFig_PcsDistribComp module</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_2_plotFig_EvolTimesComp.html">6_2_plotFig_EvolTimesComp module</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_3_plotFig_MutRatesComp.html">6_3_plotFig_MutRatesComp module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6_4_plotFig_FuncClasses module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pre-requisites">Pre-requisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-files-with-sampled-evolutionary-times">a) Files with sampled evolutionary times</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-annotated-windows">b) Annotated windows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#time-memory-disk-space">Time, Memory &amp; Disk space</a></li>
<li class="toctree-l2"><a class="reference internal" href="#function-details">Function details</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.getAnnotOrder"><code class="docutils literal notranslate"><span class="pre">getAnnotOrder()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.getAnnotTitles"><code class="docutils literal notranslate"><span class="pre">getAnnotTitles()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.getColors"><code class="docutils literal notranslate"><span class="pre">getColors()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.get_aspect"><code class="docutils literal notranslate"><span class="pre">get_aspect()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.groupWindowsByAnnotType"><code class="docutils literal notranslate"><span class="pre">groupWindowsByAnnotType()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.loadAnnotations"><code class="docutils literal notranslate"><span class="pre">loadAnnotations()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.loadEvolEstimates"><code class="docutils literal notranslate"><span class="pre">loadEvolEstimates()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.makeAnnotationMatrix"><code class="docutils literal notranslate"><span class="pre">makeAnnotationMatrix()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.makeFigure5"><code class="docutils literal notranslate"><span class="pre">makeFigure5()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.makeFigureSuppS8"><code class="docutils literal notranslate"><span class="pre">makeFigureSuppS8()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.plotFuncClassDistrib"><code class="docutils literal notranslate"><span class="pre">plotFuncClassDistrib()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotFig_FuncClasses.sortAnnotations"><code class="docutils literal notranslate"><span class="pre">sortAnnotations()</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pcsindels</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">6_4_plotFig_FuncClasses module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/6_4_plotFig_FuncClasses.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-6_4_plotFig_FuncClasses">
<span id="plotfig-funcclasses-module"></span><h1>6_4_plotFig_FuncClasses module<a class="headerlink" href="#module-6_4_plotFig_FuncClasses" title="Link to this heading"></a></h1>
<p>Plot <code class="docutils literal notranslate"><span class="pre">Figure</span> <span class="pre">5</span></code> from the paper and related plots 
from Supplementary Figures, i.e., plots related to the 
distribution of slow-evolving regions across functional classes.</p>
<p>All annotations for human (hg38) were obtained from 
<strong>UCSC Table Browser</strong>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Coding sequence coordinates were taken from the tracks <strong>GENCODE-V44</strong> and <strong>CCDS</strong>;</p></li>
<li><p>Repeats from the track <strong>RepeatMasker</strong>;</p></li>
<li><p>Regulation elements from the <strong>RefSeq</strong> track.</p></li>
</ul>
</div></blockquote>
<p>In the generated plots, rows indicate different functional classes, 
columns indicate different pairwise alignments between human and another
vertebrate (left: closest species to human; right: farthest species
from human). For each pairwise alignment, the set of 
<em>slow-evolving</em> windows was defined by selecting the windows with the
lowest evolutionary times, summing up to 308 MB (around 10% of
the human genome). Variations on this threshold were tested
and generated as Supplementary Figures.</p>
<p>For each functional class, the y-axis shows the percentage 
of windows identified as <em>slow-evolving</em> that fall
under that class, compared to the baseline (solid black line in the
middle of each graph), which denotes the percentage of windows
in the entire genome under the same functional class.</p>
<ul>
<li><p><strong>Use</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="mi">6_4</span><span class="n">_plotFig_FuncClasses</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</li>
<li><p><strong>Example of Usage</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">~/</span><span class="n">code</span><span class="o">/</span><span class="mi">6_4</span><span class="n">_plotFig_FuncClasses</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</li>
<li><p><strong>Input Parameter</strong>:</p></li>
</ul>
<p>To ensure the graphs match those used in the paper,
the parameters are hard-coded in the script and 
cannot be modified via command line.</p>
<section id="pre-requisites">
<h2>Pre-requisites<a class="headerlink" href="#pre-requisites" title="Link to this heading"></a></h2>
<p>Before using this script, make sure all the required files were pre-computed:</p>
<section id="a-files-with-sampled-evolutionary-times">
<h3>a) Files with sampled evolutionary times<a class="headerlink" href="#a-files-with-sampled-evolutionary-times" title="Link to this heading"></a></h3>
<p>Make sure to run <code class="docutils literal notranslate"><span class="pre">5_sampleEvolTimes.py</span></code> for <strong>α=1.1</strong>.</p>
</section>
<section id="b-annotated-windows">
<h3>b) Annotated windows<a class="headerlink" href="#b-annotated-windows" title="Link to this heading"></a></h3>
<p>Make sure to run <code class="docutils literal notranslate"><span class="pre">annotateWindows.py</span></code>, to annotate all windows used in the analysis.</p>
</section>
</section>
<section id="time-memory-disk-space">
<h2>Time, Memory &amp; Disk space<a class="headerlink" href="#time-memory-disk-space" title="Link to this heading"></a></h2>
<p>Running the script on a single core takes <strong>16 minutes</strong> and requires a small amount of memory. 
In total, the output files (svg+pdf plots) require 3.9 MB of disk space.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Step</p></th>
<th class="head"><p>Time (s)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Figure 5</p></td>
<td><p>248.59</p></td>
</tr>
<tr class="row-odd"><td><p>Figure 5 - SI (conserv. thresh.: ~1%)</p></td>
<td><p>214.66</p></td>
</tr>
<tr class="row-even"><td><p>Figure 5 - SI (conserv. thresh.: ~5%)</p></td>
<td><p>231.99</p></td>
</tr>
<tr class="row-odd"><td><p>Figure Supp S8</p></td>
<td><p>243.96</p></td>
</tr>
<tr class="row-even"><td><p><strong>Total time</strong></p></td>
<td><p>939.20</p></td>
</tr>
</tbody>
</table>
<p><strong>Output files</strong>:</p>
<p>A SVG version of the files listed below is also saved in the same directory:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">funcClasses-conservDistrib.conservedThresh308824475.pdf</span></code>: The PDF output file containing the plots for Figure 5;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">funcClasses-conservDistrib.conservedThresh30882447.pdf</span></code>: The PDF output file for Supp. Figure with similar plots to Figure 5, but using a different conservation threshold (1%);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">funcClasses-conservDistrib.conservedThresh154412238.pdf</span></code>: The PDF output file for Supp. Figure with similar plots to Figure 5, but using a different conservation threshold (5%);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">funcClasses-stats.overlapThresh0.0.pdf</span></code>: The PDF output file for Supp. Figure S8;</p></li>
</ol>
</div></blockquote>
</section>
<section id="function-details">
<h2>Function details<a class="headerlink" href="#function-details" title="Link to this heading"></a></h2>
<p>Only relevant functions have been documented below. 
For more details on any function, check the comments in the souce code.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.getAnnotOrder">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">getAnnotOrder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annotGrid_paper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowsLabels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.getAnnotOrder" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.getAnnotTitles">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">getAnnotTitles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annotGrid_paper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowsLabels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.getAnnotTitles" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.getColors">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">getColors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annotations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.getColors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.get_aspect">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">get_aspect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.get_aspect" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.groupWindowsByAnnotType">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">groupWindowsByAnnotType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">my_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotatedWindows</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.groupWindowsByAnnotType" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.loadAnnotations">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">loadAnnotations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">my_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_annotation</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.loadAnnotations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.loadEvolEstimates">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">loadEvolEstimates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">my_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">UCSCname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_conserved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.loadEvolEstimates" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.makeAnnotationMatrix">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">makeAnnotationMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_annotation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_conserved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.makeAnnotationMatrix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.makeFigure5">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">makeFigure5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_conserved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250000000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.makeFigure5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.makeFigureSuppS8">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">makeFigureSuppS8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.makeFigureSuppS8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.plotFuncClassDistrib">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">plotFuncClassDistrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">my_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_totbps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_selbps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.plotFuncClassDistrib" title="Link to this definition"></a></dt>
<dd><p>Plot the distribution of a given annotation in conserved windows for different species.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotFig_FuncClasses.sortAnnotations">
<span class="sig-prename descclassname"><span class="pre">6_4_plotFig_FuncClasses.</span></span><span class="sig-name descname"><span class="pre">sortAnnotations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annotations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plotFig_FuncClasses.sortAnnotations" title="Link to this definition"></a></dt>
<dd><p>Sort annotations. Each item in the list is a different annotation.
An annotation is a tuple of three numbers: (Main category: X, Sub-category: Y, Sub-sub-category: Z).
These numbers specify the hierarchical order (X.Y.Z) used in the plots.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="6_3_plotFig_MutRatesComp.html" class="btn btn-neutral float-left" title="6_3_plotFig_MutRatesComp module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Priscila Biller.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>